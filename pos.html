<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Point of Sale Interface</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"></link>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            color: #334155;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        h2 {
            color: #1e293b;
            margin-bottom: 24px;
            font-weight: 600;
        }
        
        h3 {
            color: #1e293b;
            margin-bottom: 16px;
            font-weight: 600;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            padding: 24px;
            margin-bottom: 24px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 16px;
        }
        
        th {
            background-color: #f1f5f9;
            color: #475569;
            font-weight: 500;
            text-align: left;
            padding: 12px 16px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        td {
            padding: 12px 16px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #cbd5e1;
            border-radius: 6px;
            font-size: 14px;
        }
        
        input[type="number"] {
            appearance: none;
        }
        
        .btn {
            padding: 10px 18px;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }
        
        .btn-primary {
            background-color: #3b82f6;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2563eb;
        }
        
        .btn-success {
            background-color: #10b981;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #059669;
        }
        
        .auto-suggest {
            position: absolute;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            z-index: 1000;
            width: 100%;
            max-height: 200px;
            overflow-y: auto;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            display: none;
        }
        
        .suggest-item {
            display: flex;
            align-items: center;
            padding: 10px;
            cursor: pointer;
            gap: 12px;
        }
        
        .suggest-item:hover, .suggest-item.selected {
            background-color: #f1f5f9;
        }
        
        .suggest-image {
            width: 40px;
            height: 40px;
            object-fit: cover;
            border-radius: 6px;
        }
        
        .suggest-text {
            flex-grow: 1;
        }
        
        .suggest-price {
            font-weight: 500;
            color: #059669;
        }
        
        .action-buttons {
            margin-bottom: 24px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Point of Sale Interface</h2>
        
        <div class="card">
            <table id="pos-table">
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Quantity</th>
                        <th>Total</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="relative">
                            <input type="text" class="product-input w-full" placeholder="Search Product" autocomplete="off" tabindex="1" />
                            <div class="auto-suggest"></div>
                        </td>
                        <td>
                            <input type="number" class="quantity-input w-full" value="1" min="1" tabindex="2" />
                        </td>
                        <td>
                            <span class="total-display font-medium">$0.00</span>
                        </td>
                    </tr>
                </tbody>
            </table>
            
            <div class="action-buttons">
                <button class="btn btn-primary" id="add-row-btn">
                    <i class="fas fa-plus mr-2"></i>Add Item
                </button>
                <button class="btn btn-success ml-2" id="process-transaction-btn">
                    <i class="fas fa-receipt mr-2"></i>Process Transaction
                </button>
            </div>
        </div>
        
        <div class="card">
            <h3>Total Sales Summary</h3>
            <table id="sales-summary-table">
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Quantity</th>
                        <th>Total Price</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // Product data with images
        const products = [
            { name: "Apple", price: 1.50, image: "https://picsum.photos/seed/apple/80/80.jpg" },
            { name: "Banana", price: 0.80, image: "https://picsum.photos/seed/banana/80/80.jpg" },
            { name: "Orange", price: 1.20, image: "https://picsum.photos/seed/orange/80/80.jpg" },
            { name: "Grapes", price: 2.00, image: "https://picsum.photos/seed/grapes/80/80.jpg" },
            { name: "Mango", price: 1.70, image: "https://picsum.photos/seed/mango/80/80.jpg" },
            { name: "Pineapple", price: 3.50, image: "https://picsum.photos/seed/pineapple/80/80.jpg" },
            { name: "Strawberry", price: 2.25, image: "https://picsum.photos/seed/strawberry/80/80.jpg" },
            { name: "Watermelon", price: 4.00, image: "https://picsum.photos/seed/watermelon/80/80.jpg" },
            { name: "Kiwi", price: 1.90, image: "https://picsum.photos/seed/kiwi/80/80.jpg" },
            { name: "Blueberry", price: 3.75, image: "https://picsum.photos/seed/blueberry/80/80.jpg" }
        ];
        
        let salesData = [];
        let selectedSuggestionIndex = -1;
        
        // Function to create a new row
        function addNewRow() {
            const tbody = $("#pos-table tbody");
            const newRow = $("<tr></tr>");
            newRow.html(`
                <td class="relative">
                    <input type="text" class="product-input w-full" placeholder="Search Product" autocomplete="off" tabindex="1" />
                    <div class="auto-suggest"></div>
                </td>
                <td>
                    <input type="number" class="quantity-input w-full" value="1" min="1" tabindex="2" />
                </td>
                <td>
                    <span class="total-display font-medium">$0.00</span>
                </td>
            `);
            tbody.append(newRow);
            attachEventListeners(newRow);
        }
        
        // Function to attach event listeners to a row
        function attachEventListeners(row) {
            const productInput = row.find(".product-input");
            const quantityInput = row.find(".quantity-input");
            const totalDisplay = row.find(".total-display");
            const suggestionBox = row.find(".auto-suggest");
            
            // Handle product search and suggestions
            productInput.on("input", function() {
                const query = $(this).val().toLowerCase();
                suggestionBox.empty();
                selectedSuggestionIndex = -1;
                
                if (query.length > 0) {
                    const filteredProducts = products.filter(product => 
                        product.name.toLowerCase().includes(query)
                    );
                    
                    if (filteredProducts.length > 0) {
                        filteredProducts.forEach(product => {
                            const item = $(`<div class="suggest-item"></div>`);
                            item.html(`
                                <img src="${product.image}" alt="${product.name}" class="suggest-image" />
                                <div class="suggest-text">
                                    <div>${product.name}</div>
                                    <div class="suggest-price">$${product.price.toFixed(2)}</div>
                                </div>
                            `);
                            
                            item.on("click", function() {
                                productInput.val(product.name);
                                calculateTotal(row);
                                suggestionBox.hide();
                                selectedSuggestionIndex = -1;
                                
                                // Add new row after selection
                                setTimeout(() => {
                                    addNewRow();
                                }, 100);
                            });
                            
                            suggestionBox.append(item);
                        });
                        
                        suggestionBox.show();
                    } else {
                        suggestionBox.hide();
                    }
                } else {
                    suggestionBox.hide();
                }
            });
            
            // Update total when quantity changes
            quantityInput.on("input", function() {
                calculateTotal(row);
            });
            
            // Add new row on Enter key
            productInput.on("keypress", function(e) {
                if (e.key === "Enter") {
                    e.preventDefault();
                    addNewRow();
                }
            });
            
            // Handle arrow key navigation
            productInput.on("keydown", function(e) {
                handleArrowNavigation(e, row, "product");
            });
            
            quantityInput.on("keydown", function(e) {
                handleArrowNavigation(e, row, "quantity");
            });
            
            // Handle dropdown navigation
            productInput.on("keydown", function(e) {
                if (suggestionBox.is(":visible")) {
                    handleDropdownNavigation(e, suggestionBox);
                }
            });
        }
        
        // Function to handle dropdown navigation
        function handleDropdownNavigation(e, suggestionBox) {
            const keyCode = e.keyCode;
            const items = suggestionBox.children();
            
            if (keyCode === 40) { // Down arrow
                e.preventDefault();
                if (selectedSuggestionIndex < items.length - 1) {
                    selectedSuggestionIndex++;
                    updateSelectedSuggestion(items, selectedSuggestionIndex);
                }
            } else if (keyCode === 38) { // Up arrow
                e.preventDefault();
                if (selectedSuggestionIndex > 0) {
                    selectedSuggestionIndex--;
                    updateSelectedSuggestion(items, selectedSuggestionIndex);
                }
            } else if (keyCode === 13) { // Enter
                e.preventDefault();
                if (selectedSuggestionIndex >= 0) {
                    const selectedItem = items.eq(selectedSuggestionIndex);
                    const productName = selectedItem.data('name');
                    const productPrice = selectedItem.data('price');
                    
                    const productInput = selectedItem.closest('tr').find('.product-input');
                    productInput.val(productName);
                    productInput.closest('tr').find('.total-display').text(`$${(productPrice * parseInt(productInput.closest('tr').find('.quantity-input').val())).toFixed(2)}`);
                    
                    suggestionBox.hide();
                    selectedSuggestionIndex = -1;
                    
                    // Add new row after selection
                    setTimeout(() => {
                        addNewRow();
                    }, 100);
                }
            }
        }
        
        // Function to update selected suggestion
        function updateSelectedSuggestion(items, index) {
            items.removeClass('selected');
            items.eq(index).addClass('selected');
        }
        
        // Function to handle arrow key navigation
        function handleArrowNavigation(e, row, currentField) {
            const keyCode = e.keyCode;
            const isLastRow = row.is(":last-child");
            const isFirstRow = row.is(":first-row");
            
            switch(keyCode) {
                case 37: // Left arrow
                case 39: // Right arrow
                    return; // Skip horizontal navigation
                    
                case 38: // Up arrow
                    if (!isFirstRow) {
                        e.preventDefault();
                        const prevRow = row.prev();
                        if (currentField === "product") {
                            prevRow.find(".product-input").focus();
                        } else {
                            prevRow.find(".quantity-input").focus();
                        }
                    }
                    break;
                    
                case 40: // Down arrow
                    if (!isLastRow) {
                        e.preventDefault();
                        const nextRow = row.next();
                        if (currentField === "product") {
                            nextRow.find(".product-input").focus();
                        } else {
                            nextRow.find(".quantity-input").focus();
                        }
                    }
                    break;
                    
                case 9: // Tab key
                    e.preventDefault();
                    if (currentField === "product") {
                        row.find(".quantity-input").focus();
                    } else if (currentField === "quantity") {
                        if (!isLastRow) {
                            const nextRow = row.next();
                            nextRow.find(".product-input").focus();
                        } else {
                            addNewRow();
                            const newRow = $("#pos-table tbody tr:last");
                            newRow.find('.product-input').focus();
                        }
                    }
                    break;
            }
        }
        
        // Function to calculate total for a row
        function calculateTotal(row) {
            const productInput = row.find(".product-input");
            const quantityInput = row.find(".quantity-input");
            const totalDisplay = row.find(".total-display");
            
            const productName = productInput.val();
            const quantity = parseInt(quantityInput.val()) || 0;
            
            const product = products.find(p => p.name === productName);
            
            if (product && quantity > 0) {
                const total = product.price * quantity;
                totalDisplay.text("$" + total.toFixed(2));
            } else {
                totalDisplay.text("$0.00");
            }
        }
        
        // Process transaction
        function processTransaction() {
            const rows = $("#pos-table tbody tr");
            const salesSummary = [];
            
            rows.each(function(index) {
                const row = $(this);
                const productName = row.find(".product-input").val();
                const quantity = parseInt(row.find(".quantity-input").val()) || 0;
                const totalText = row.find(".total-display").text();
                const total = parseFloat(totalText.replace('$', '')) || 0;
                
                if (productName && quantity > 0 && total > 0) {
                    salesSummary.push({
                        product: productName,
                        quantity: quantity,
                        total: total
                    });
                }
            });
            
            // Display sales summary
            const salesTableBody = $("#sales-summary-table tbody");
            salesTableBody.empty();
            
            salesSummary.forEach(item => {
                const row = $(`<tr></tr>`);
                row.html(`
                    <td>${item.product}</td>
                    <td>${item.quantity}</td>
                    <td>$${item.total.toFixed(2)}</td>
                `);
                salesTableBody.append(row);
            });
            
            // Calculate and display grand total
            const grandTotal = salesSummary.reduce((sum, item) => sum + item.total, 0);
            if (grandTotal > 0) {
                const totalRow = $(`<tr class="font-bold bg-gray-50"></tr>`);
                totalRow.html(`
                    <td colspan="2">Grand Total:</td>
                    <td>$${grandTotal.toFixed(2)}</td>
                `);
                salesTableBody.append(totalRow);
            }
        }
        
        // Close suggestion boxes when clicking outside
        $(document).on("click", function(e) {
            if (!$(e.target).closest(".product-input").length) {
                $(".auto-suggest").hide();
            }
        });
        
        // Initialize event listeners for the first row
        attachEventListeners($("#pos-table tbody tr:first"));
        
        // Button click handlers
        $("#add-row-btn").on("click", addNewRow);
        $("#process-transaction-btn").on("click", processTransaction);
    </script>
</body>
</html>