<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POS System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1rem;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
        }

        /* Mobile responsive grid */
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 15px;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .header p {
                font-size: 0.9rem;
            }
        }

        .search-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }

        .search-section h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .search-container {
            position: relative;
            margin-bottom: 20px;
        }

        #searchInput {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s;
        }

        #searchInput:focus {
            border-color: #667eea;
        }

        .suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .suggestion-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
        }

        .suggestion-item:hover {
            background-color: #f8f9fa;
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        .suggestion-image {
            width: 40px;
            height: 40px;
            object-fit: cover;
            border-radius: 6px;
            margin-right: 12px;
        }

        .suggestion-info {
            flex: 1;
        }

        .suggestion-name {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 2px;
        }

        .suggestion-price {
            color: #28a745;
            font-weight: 600;
        }

        .selected-products {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            min-height: 300px;
        }

        .selected-products h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .selected-product {
            display: flex;
            align-items: center;
            background: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 1px solid #e9ecef;
        }

        /* Mobile responsive selected product layout */
        @media (max-width: 768px) {
            .selected-product {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
                padding: 12px;
            }
            
            .selected-product-image {
                width: 50px !important;
                height: 50px !important;
                margin-right: 0 !important;
                margin-bottom: 8px;
            }
            
            .selected-product-info {
                width: 100% !important;
                margin-right: 0 !important;
            }
            
            .quantity-controls {
                width: 100% !important;
                justify-content: space-between !important;
                flex-wrap: wrap;
                gap: 5px;
            }
            
            .remove-btn {
                margin-left: 0 !important;
                margin-top: 5px;
                width: 100%;
                padding: 8px !important;
            }
        }

        .selected-product-image {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 8px;
            margin-right: 15px;
        }

        .selected-product-info {
            flex: 1;
            margin-right: 15px;
        }

        .selected-product-name {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 1rem;
        }

        .selected-product-price {
            color: #28a745;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quantity-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.2s;
        }

        .quantity-btn:hover {
            background: #5a6268;
        }

        .quantity-btn:last-of-type {
            background: #28a745;
        }

        .quantity-btn:last-of-type:hover {
            background: #218838;
        }

        .remove-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.2s;
            margin-left: 10px;
        }

        .remove-btn:hover {
            background: #c82333;
        }

        .finish-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            width: 100%;
            margin-top: 15px;
            transition: transform 0.2s;
        }

        .finish-btn:hover:not(:disabled) {
            transform: translateY(-2px);
        }

        .finish-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        .checkout-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            margin-top: 20px;
        }

        .checkout-section h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .checkout-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .checkout-table th,
        .checkout-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .checkout-table th {
            background: #2c3e50;
            color: white;
            font-weight: 600;
        }

        .checkout-table tr:last-child td {
            border-bottom: none;
        }

        .payment-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        /* Mobile responsive payment buttons */
        @media (max-width: 768px) {
            .payment-buttons {
                flex-direction: column;
                gap: 8px;
            }
            
            .payment-btn {
                width: 100% !important;
                padding: 12px !important;
            }
        }

        .payment-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.2s;
        }

        .payment-btn:hover {
            transform: translateY(-1px);
        }

        .cash-btn {
            background: #28a745;
            color: white;
        }

        .card-btn {
            background: #007bff;
            color: white;
        }

        .new-sale-btn {
            background: #6c757d;
            color: white;
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.2s;
        }

        .new-sale-btn:hover {
            background: #5a6268;
        }

        .sales-history-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            margin-top: 20px;
        }

        .sales-history-section h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .sales-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        /* Mobile responsive sales summary */
        @media (max-width: 768px) {
            .sales-summary {
                grid-template-columns: 1fr;
                gap: 10px;
            }
        }

        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 1px solid #e9ecef;
        }

        .summary-card h3 {
            color: #6c757d;
            font-size: 0.9rem;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .summary-card .value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2c3e50;
        }

        .summary-card .total-sales .value {
            color: #28a745;
        }

        .summary-card .total-transactions .value {
            color: #007bff;
        }

        .summary-card .average-sale .value {
            color: #ffc107;
        }

        .transactions-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .transactions-table th,
        .transactions-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .transactions-table th {
            background: #2c3e50;
            color: white;
            font-weight: 600;
        }

        .transactions-table tr:last-child td {
            border-bottom: none;
        }

                 /* Action buttons */
         .action-buttons {
             display: flex;
             gap: 5px;
             flex-wrap: wrap;
         }

                   .action-btn {
              padding: 8px;
              border: none;
              border-radius: 4px;
              cursor: pointer;
              font-size: 1rem;
              transition: all 0.2s;
              display: inline-flex;
              align-items: center;
              justify-content: center;
              width: 32px;
              height: 32px;
          }

         .preview-btn {
             background: #17a2b8;
             color: white;
         }

         .preview-btn:hover {
             background: #138496;
         }

         .edit-btn {
             background: #ffc107;
             color: #212529;
         }

         .edit-btn:hover {
             background: #e0a800;
         }

         .delete-btn {
             background: #dc3545;
             color: white;
         }

         .delete-btn:hover {
             background: #c82333;
         }

         /* Mobile responsive tables */
                   @media (max-width: 768px) {
              .checkout-table,
              .transactions-table {
                  font-size: 0.85rem;
              }
              
              .checkout-table th,
              .checkout-table td,
              .transactions-table th,
              .transactions-table td {
                  padding: 8px 6px;
              }
              
              .checkout-table th:nth-child(2),
              .checkout-table td:nth-child(2),
              .transactions-table th:nth-child(3),
              .transactions-table td:nth-child(3) {
                  display: none;
              }

              /* Hide Time column and show Total instead on mobile */
              .transactions-table th:nth-child(5),
              .transactions-table td:nth-child(5) {
                  display: none;
              }

                            .action-buttons {
                   flex-direction: column;
                   gap: 3px;
               }

               .action-btn {
                   padding: 6px;
                   font-size: 0.9rem;
                   width: 28px;
                   height: 28px;
               }
          }

         @media (max-width: 480px) {
             .transactions-table th:nth-child(2),
             .transactions-table td:nth-child(2),
             .transactions-table th:nth-child(4),
             .transactions-table td:nth-child(4) {
                 display: none;
             }
         }

        .no-products {
            text-align: center;
            color: #6c757d;
            font-style: italic;
            padding: 40px 20px;
        }

                 .hidden {
             display: none !important;
         }

         /* Modal styles */
         .modal {
             display: none;
             position: fixed;
             z-index: 10000;
             left: 0;
             top: 0;
             width: 100%;
             height: 100%;
             background-color: rgba(0,0,0,0.5);
             backdrop-filter: blur(5px);
         }

                   .modal-content {
              background-color: white;
              margin: 2% auto;
              padding: 0;
              border-radius: 12px;
              width: 90%;
              max-width: 600px;
              max-height: 90vh;
              overflow-y: auto;
              box-shadow: 0 20px 40px rgba(0,0,0,0.3);
              animation: modalSlideIn 0.3s ease-out;
          }

         @keyframes modalSlideIn {
             from {
                 opacity: 0;
                 transform: translateY(-50px);
             }
             to {
                 opacity: 1;
                 transform: translateY(0);
             }
         }

         .modal-header {
             background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
             color: white;
             padding: 20px;
             border-radius: 12px 12px 0 0;
             display: flex;
             justify-content: space-between;
             align-items: center;
         }

         .modal-header h2 {
             margin: 0;
             font-size: 1.3rem;
         }

         .close {
             color: white;
             font-size: 28px;
             font-weight: bold;
             cursor: pointer;
             transition: opacity 0.2s;
         }

         .close:hover {
             opacity: 0.7;
         }

         .modal-body {
             padding: 20px;
         }

         .transaction-details {
             display: grid;
             grid-template-columns: 1fr 1fr;
             gap: 20px;
             margin-bottom: 20px;
         }

         .detail-group {
             background: #f8f9fa;
             padding: 15px;
             border-radius: 8px;
             border: 1px solid #e9ecef;
         }

         .detail-label {
             font-weight: 600;
             color: #6c757d;
             font-size: 0.9rem;
             text-transform: uppercase;
             letter-spacing: 0.5px;
             margin-bottom: 5px;
         }

         .detail-value {
             font-size: 1.1rem;
             color: #2c3e50;
             font-weight: 600;
         }

         .products-list {
             background: white;
             border: 1px solid #e9ecef;
             border-radius: 8px;
             overflow: hidden;
         }

         .products-header {
             background: #2c3e50;
             color: white;
             padding: 12px 15px;
             font-weight: 600;
         }

                   .product-item {
              padding: 15px;
              border-bottom: 1px solid #e9ecef;
              display: flex;
              justify-content: space-between;
              align-items: center;
          }

          .product-item:last-child {
              border-bottom: none;
          }

          .product-info {
              display: flex;
              align-items: center;
              gap: 12px;
              flex: 1;
          }

          .modal-product-image {
              width: 50px;
              height: 50px;
              object-fit: cover;
              border-radius: 8px;
              border: 1px solid #e9ecef;
          }

          .product-details {
              flex: 1;
          }

          .product-name {
              font-weight: 600;
              color: #2c3e50;
              margin-bottom: 4px;
              font-size: 1rem;
          }

          .product-quantity {
              color: #6c757d;
              font-size: 0.9rem;
          }

          .product-total {
              color: #28a745;
              font-weight: 600;
              font-size: 1.1rem;
          }

                   @media (max-width: 768px) {
              .modal-content {
                  margin: 5% auto;
                  width: 95%;
              }

              .transaction-details {
                  grid-template-columns: 1fr;
                  gap: 15px;
              }

              .modal-body {
                  padding: 15px;
              }

              .product-item {
                  padding: 12px;
              }

              .modal-product-image {
                  width: 40px;
                  height: 40px;
              }

              .product-name {
                  font-size: 0.9rem;
              }

              .product-quantity {
                  font-size: 0.8rem;
              }

              .product-total {
                  font-size: 1rem;
              }
          }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõçÔ∏è Point of Sale System</h1>
            <p>Professional Sales Management</p>
        </div>

        <div class="main-content">
            <div class="left-panel">
                <div class="search-section">
                    <h2>üîç Search Products</h2>
                    <div class="search-container">
                        <input type="text" id="searchInput" placeholder="Type product name to search..." autocomplete="off">
                        <div id="suggestions" class="suggestions hidden"></div>
                    </div>
                </div>

                <div class="selected-products">
                    <h2>üì¶ Selected Products</h2>
                    <div id="productList">
                        <p style="text-align: center; color: #6c757d; font-style: italic;">No products selected yet. Start searching above!</p>
                    </div>
                    <button id="finishBtn" class="finish-btn" disabled onclick="finishProcess()">Finish Process</button>
                </div>
            </div>

            <div class="right-panel">
                <div class="checkout-section hidden" id="checkoutSection">
                    <h2>üí≥ Checkout</h2>
                    <table class="checkout-table" id="checkoutTable">
                        <thead>
                            <tr>
                                <th>Item</th>
                                <th>Qty</th>
                                <th>Price</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody id="checkoutBody"></tbody>
                        <tfoot>
                            <tr>
                                <td colspan="3" style="text-align: right; font-weight: bold;">Total:</td>
                                <td id="checkoutTotal" style="font-weight: bold; color: #28a745;"></td>
                            </tr>
                        </tfoot>
                    </table>
                    <div class="payment-buttons">
                        <button class="payment-btn cash-btn" onclick="processPayment('Cash')">üíµ Cash Payment</button>
                        <button class="payment-btn card-btn" onclick="processPayment('Card')">üí≥ Card Payment</button>
                    </div>
                    <button class="new-sale-btn" onclick="startNewSale()">üîÑ Start New Sale</button>
                </div>

                <div class="sales-history-section">
                    <h2>üìä Today's Sales</h2>
                    <div class="sales-summary">
                        <div class="summary-card total-sales">
                            <h3>Total Sales</h3>
                            <div class="value" id="totalSales">$0.00</div>
                        </div>
                        <div class="summary-card total-transactions">
                            <h3>Transactions</h3>
                            <div class="value" id="totalTransactions">0</div>
                        </div>
                        <div class="summary-card average-sale">
                            <h3>Average Sale</h3>
                            <div class="value" id="averageSale">$0.00</div>
                        </div>
                    </div>
                                         <table class="transactions-table" id="transactionsTable">
                         <thead>
                             <tr>
                                 <th>Customer</th>
                                 <th>Items</th>
                                 <th>Payment</th>
                                 <th>Total</th>
                                 <th>Time</th>
                                 <th>Actions</th>
                             </tr>
                         </thead>
                         <tbody id="transactionsBody"></tbody>
                     </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample product data
        const products = [
            { id: 1, name: "iPhone 15 Pro", price: 999.99, image: "https://images.unsplash.com/photo-1592750475338-74b7b21085ab?w=100&h=100&fit=crop" },
            { id: 2, name: "Samsung Galaxy S24", price: 899.99, image: "https://images.unsplash.com/photo-1610945265064-0e34e5519bbf?w=100&h=100&fit=crop" },
            { id: 3, name: "MacBook Pro 14", price: 1999.99, image: "https://images.unsplash.com/photo-1517336714731-489689fd1ca8?w=100&h=100&fit=crop" },
            { id: 4, name: "Dell XPS 13", price: 1299.99, image: "https://images.unsplash.com/photo-1588872657578-7efd1f1555ed?w=100&h=100&fit=crop" },
            { id: 5, name: "AirPods Pro", price: 249.99, image: "https://images.unsplash.com/photo-1606220945770-b5b6c2c55bf1?w=100&h=100&fit=crop" },
            { id: 6, name: "Sony WH-1000XM5", price: 399.99, image: "https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=100&h=100&fit=crop" },
            { id: 7, name: "iPad Air", price: 599.99, image: "https://images.unsplash.com/photo-1544244015-0df4b3ffc6b0?w=100&h=100&fit=crop" },
            { id: 8, name: "Apple Watch Series 9", price: 399.99, image: "https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=100&h=100&fit=crop" },
            { id: 9, name: "Nintendo Switch OLED", price: 349.99, image: "https://images.unsplash.com/photo-1578303512597-81e6cc155b3e?w=100&h=100&fit=crop" },
            { id: 10, name: "PlayStation 5", price: 499.99, image: "https://images.unsplash.com/photo-1606813907291-d86efa9b94db?w=100&h=100&fit=crop" }
        ];

                 // Dummy transaction data with detailed product information
         const dummyTransactions = [
             { 
                 id: 1, 
                 time: "09:15 AM", 
                 customer: "John Smith", 
                 items: 3, 
                 payment: "Card", 
                 total: 1249.97, 
                 products: [
                     { name: "iPhone 15 Pro", price: 999.99, quantity: 1, image: "https://images.unsplash.com/photo-1592750475338-74b7b21085ab?w=100&h=100&fit=crop" },
                     { name: "AirPods Pro", price: 249.99, quantity: 1, image: "https://images.unsplash.com/photo-1606220945770-b5b6c2c55bf1?w=100&h=100&fit=crop" },
                     { name: "iPad Air", price: 599.99, quantity: 1, image: "https://images.unsplash.com/photo-1544244015-0df4b3ffc6b0?w=100&h=100&fit=crop" }
                 ]
             },
             { 
                 id: 2, 
                 time: "10:30 AM", 
                 customer: "Sarah Johnson", 
                 items: 1, 
                 payment: "Cash", 
                 total: 999.99, 
                 products: [
                     { name: "iPhone 15 Pro", price: 999.99, quantity: 1, image: "https://images.unsplash.com/photo-1592750475338-74b7b21085ab?w=100&h=100&fit=crop" }
                 ]
             },
             { 
                 id: 3, 
                 time: "11:45 AM", 
                 customer: "Mike Davis", 
                 items: 2, 
                 payment: "Card", 
                 total: 649.98, 
                 products: [
                     { name: "AirPods Pro", price: 249.99, quantity: 1, image: "https://images.unsplash.com/photo-1606220945770-b5b6c2c55bf1?w=100&h=100&fit=crop" },
                     { name: "Sony WH-1000XM5", price: 399.99, quantity: 1, image: "https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=100&h=100&fit=crop" }
                 ]
             },
             { 
                 id: 4, 
                 time: "01:20 PM", 
                 customer: "Emily Wilson", 
                 items: 4, 
                 payment: "Cash", 
                 total: 1899.96, 
                 products: [
                     { name: "MacBook Pro 14", price: 1999.99, quantity: 1, image: "https://images.unsplash.com/photo-1517336714731-489689fd1ca8?w=100&h=100&fit=crop" },
                     { name: "Dell XPS 13", price: 1299.99, quantity: 1, image: "https://images.unsplash.com/photo-1588872657578-7efd1f1555ed?w=100&h=100&fit=crop" },
                     { name: "Apple Watch Series 9", price: 399.99, quantity: 1, image: "https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=100&h=100&fit=crop" },
                     { name: "Nintendo Switch OLED", price: 349.99, quantity: 1, image: "https://images.unsplash.com/photo-1578303512597-81e6cc155b3e?w=100&h=100&fit=crop" }
                 ]
             },
             { 
                 id: 5, 
                 time: "02:15 PM", 
                 customer: "David Brown", 
                 items: 1, 
                 payment: "Card", 
                 total: 399.99, 
                 products: [
                     { name: "Apple Watch Series 9", price: 399.99, quantity: 1, image: "https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=100&h=100&fit=crop" }
                 ]
             },
             { 
                 id: 6, 
                 time: "03:30 PM", 
                 customer: "Lisa Garcia", 
                 items: 2, 
                 payment: "Cash", 
                 total: 749.98, 
                 products: [
                     { name: "Samsung Galaxy S24", price: 899.99, quantity: 1, image: "https://images.unsplash.com/photo-1610945265064-0e34e5519bbf?w=100&h=100&fit=crop" },
                     { name: "PlayStation 5", price: 499.99, quantity: 1, image: "https://images.unsplash.com/photo-1606813907291-d86efa9b94db?w=100&h=100&fit=crop" }
                 ]
             },
             { 
                 id: 7, 
                 time: "04:45 PM", 
                 customer: "Robert Lee", 
                 items: 3, 
                 payment: "Card", 
                 total: 1549.97, 
                 products: [
                     { name: "MacBook Pro 14", price: 1999.99, quantity: 1, image: "https://images.unsplash.com/photo-1517336714731-489689fd1ca8?w=100&h=100&fit=crop" },
                     { name: "AirPods Pro", price: 249.99, quantity: 1, image: "https://images.unsplash.com/photo-1606220945770-b5b6c2c55bf1?w=100&h=100&fit=crop" },
                     { name: "iPad Air", price: 599.99, quantity: 1, image: "https://images.unsplash.com/photo-1544244015-0df4b3ffc6b0?w=100&h=100&fit=crop" }
                 ]
             }
         ];

        let selectedProducts = [];
        let transactionHistory = [...dummyTransactions];
        let transactionCounter = dummyTransactions.length;

        const searchInput = document.getElementById('searchInput');
        const suggestions = document.getElementById('suggestions');
        const productList = document.getElementById('productList');
        const finishBtn = document.getElementById('finishBtn');

        // Initialize with dummy data
        updateSalesSummary();
        updateTransactionsTable();

        searchInput.addEventListener('input', function() {
            const query = this.value.toLowerCase();
            if (query.length < 2) {
                hideSuggestions();
                return;
            }

            const filteredProducts = products.filter(product =>
                product.name.toLowerCase().includes(query)
            );

            showSuggestions(filteredProducts);
        });

        searchInput.addEventListener('blur', function() {
            setTimeout(hideSuggestions, 200);
        });

        function showSuggestions(products) {
            if (products.length === 0) {
                hideSuggestions();
                return;
            }

            suggestions.innerHTML = products.map(product =>
                '<div class="suggestion-item" onclick="selectProduct(' + product.id + ')">' +
                    '<img src="' + product.image + '" alt="' + product.name + '" class="suggestion-image">' +
                    '<div class="suggestion-info">' +
                        '<div class="suggestion-name">' + product.name + '</div>' +
                        '<div class="suggestion-price">$' + product.price.toFixed(2) + '</div>' +
                    '</div>' +
                '</div>'
            ).join('');

            suggestions.classList.remove('hidden');
        }

        function hideSuggestions() {
            suggestions.classList.add('hidden');
        }

        function selectProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            const existingProduct = selectedProducts.find(p => p.id === productId);
            if (existingProduct) {
                existingProduct.quantity += 1;
            } else {
                selectedProducts.push({
                    ...product,
                    quantity: 1
                });
            }

            updateProductList();
            searchInput.value = '';
            hideSuggestions();
        }

        function updateQuantity(productId, change) {
            const product = selectedProducts.find(p => p.id === productId);
            if (!product) return;

            product.quantity += change;
            if (product.quantity <= 0) {
                removeProduct(productId);
            } else {
                updateProductList();
            }
        }

        function removeProduct(productId) {
            selectedProducts = selectedProducts.filter(p => p.id !== productId);
            updateProductList();
        }

        function updateProductList() {
            if (selectedProducts.length === 0) {
                productList.innerHTML = '<p style="text-align: center; color: #6c757d; font-style: italic;">No products selected yet. Start searching above!</p>';
                finishBtn.disabled = true;
            } else {
                productList.innerHTML = selectedProducts.map(product =>
                    '<div class="selected-product">' +
                        '<img src="' + product.image + '" alt="' + product.name + '" class="selected-product-image">' +
                        '<div class="selected-product-info">' +
                            '<div class="selected-product-name">' + product.name + '</div>' +
                            '<div class="selected-product-price">$' + product.price.toFixed(2) + ' √ó ' + product.quantity + ' = $' + (product.price * product.quantity).toFixed(2) + '</div>' +
                        '</div>' +
                        '<div class="quantity-controls">' +
                            '<button class="quantity-btn" onclick="updateQuantity(' + product.id + ', -1)">-</button>' +
                            '<span style="font-weight: bold; min-width: 20px; text-align: center;">' + product.quantity + '</span>' +
                            '<button class="quantity-btn" onclick="updateQuantity(' + product.id + ', 1)">+</button>' +
                            '<button class="remove-btn" onclick="removeProduct(' + product.id + ')">Remove</button>' +
                        '</div>' +
                    '</div>'
                ).join('');
                finishBtn.disabled = false;
            }
            updateTotals();
        }

        function updateTotals() {
            const total = selectedProducts.reduce((sum, product) => sum + (product.price * product.quantity), 0);
            // You can add total display here if needed
        }

        function finishProcess() {
            if (selectedProducts.length === 0) {
                alert('Please select at least one product!');
                return;
            }

            updateCheckoutTable();
            document.getElementById('checkoutSection').classList.remove('hidden');
            document.getElementById('checkoutSection').scrollIntoView({ behavior: 'smooth' });
        }

        function updateCheckoutTable() {
            const checkoutBody = document.getElementById('checkoutBody');
            const checkoutTotal = document.getElementById('checkoutTotal');
            
            checkoutBody.innerHTML = selectedProducts.map(product =>
                '<tr>' +
                    '<td>' + product.name + '</td>' +
                    '<td>' + product.quantity + '</td>' +
                    '<td>$' + product.price.toFixed(2) + '</td>' +
                    '<td>$' + (product.price * product.quantity).toFixed(2) + '</td>' +
                '</tr>'
            ).join('');

            const total = selectedProducts.reduce((sum, product) => sum + (product.price * product.quantity), 0);
            checkoutTotal.textContent = '$' + total.toFixed(2);
        }

        function processPayment(method) {
            const total = selectedProducts.reduce((sum, product) => sum + (product.price * product.quantity), 0);
            
            // Add to transaction history
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: true 
            });
            
                         const newTransaction = {
                 id: transactionCounter + 1,
                 time: timeString,
                 customer: 'Walk-in Customer', // You can add customer input later
                 items: selectedProducts.reduce((sum, product) => sum + product.quantity, 0),
                 payment: method,
                 total: total,
                 products: selectedProducts.map(product => ({
                     name: product.name,
                     price: product.price,
                     quantity: product.quantity,
                     image: product.image
                 }))
             };
            
            transactionHistory.unshift(newTransaction);
            transactionCounter++;
            
            updateSalesSummary();
            updateTransactionsTable();
            
            // Print receipt
            printReceipt(method, total);
            
            alert('Payment processed successfully! Receipt printed.');
        }

        function printReceipt(paymentMethod, total) {
            const printWindow = window.open('', '_blank');
            const receiptContent = 
                '<html><head><title>Receipt</title>' +
                '<style>' +
                'body { font-family: Arial, sans-serif; margin: 20px; }' +
                '.receipt { max-width: 300px; margin: 0 auto; }' +
                '.header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 20px; }' +
                '.item { display: flex; justify-content: space-between; margin-bottom: 5px; }' +
                '.total { border-top: 1px solid #000; padding-top: 10px; margin-top: 10px; font-weight: bold; }' +
                '.footer { text-align: center; margin-top: 20px; font-size: 12px; }' +
                '</style></head><body>' +
                '<div class="receipt">' +
                    '<div class="header">' +
                        '<h2>üõçÔ∏è POS System</h2>' +
                        '<p>Receipt #' + transactionCounter.toString().padStart(4, '0') + '</p>' +
                        '<p>' + new Date().toLocaleString() + '</p>' +
                    '</div>' +
                    '<div class="items">' +
                        selectedProducts.map(product => 
                            '<div class="item">' +
                                '<span>' + product.name + ' x' + product.quantity + '</span>' +
                                '<span>$' + (product.price * product.quantity).toFixed(2) + '</span>' +
                            '</div>'
                        ).join('') +
                    '</div>' +
                    '<div class="total">' +
                        '<div class="item">' +
                            '<span>Total:</span>' +
                            '<span>$' + total.toFixed(2) + '</span>' +
                        '</div>' +
                        '<div class="item">' +
                            '<span>Payment:</span>' +
                            '<span>' + paymentMethod + '</span>' +
                        '</div>' +
                    '</div>' +
                    '<div class="footer">' +
                        '<p>Thank you for your purchase!</p>' +
                        '<p>Have a great day! üòä</p>' +
                    '</div>' +
                '</div>' +
                '</body></html>';
            
            printWindow.document.write(receiptContent);
            printWindow.document.close();
            printWindow.print();
        }

        function startNewSale() {
            selectedProducts = [];
            updateProductList();
            document.getElementById('checkoutSection').classList.add('hidden');
            searchInput.value = '';
            hideSuggestions();
            searchInput.focus();
            alert('New sale started! Ready for next customer.');
        }

        function updateSalesSummary() {
            const totalSales = transactionHistory.reduce((sum, transaction) => sum + transaction.total, 0);
            const totalTransactions = transactionHistory.length;
            const averageSale = totalTransactions > 0 ? totalSales / totalTransactions : 0;
            
            document.getElementById('totalSales').textContent = '$' + totalSales.toFixed(2);
            document.getElementById('totalTransactions').textContent = totalTransactions;
            document.getElementById('averageSale').textContent = '$' + averageSale.toFixed(2);
        }

                 function updateTransactionsTable() {
             const transactionsBody = document.getElementById('transactionsBody');
             
             transactionsBody.innerHTML = transactionHistory.map(transaction =>
                 '<tr>' +
                     '<td>' + (transaction.customer || 'Walk-in Customer') + '</td>' +
                     '<td>' + transaction.items + ' items</td>' +
                     '<td>' + transaction.payment + '</td>' +
                     '<td>$' + transaction.total.toFixed(2) + '</td>' +
                     '<td>' + transaction.time + '</td>' +
                     '<td>' +
                         '<div class="action-buttons">' +
                             '<button class="action-btn preview-btn" onclick="previewTransaction(' + transaction.id + ')" title="Preview">üëÅÔ∏è</button>' +
                             '<button class="action-btn edit-btn" onclick="editTransaction(' + transaction.id + ')" title="Edit">‚úèÔ∏è</button>' +
                             '<button class="action-btn delete-btn" onclick="deleteTransaction(' + transaction.id + ')" title="Delete">üóëÔ∏è</button>' +
                         '</div>' +
                     '</td>' +
                 '</tr>'
             ).join('');
         }

                   function previewTransaction(id) {
              const transaction = transactionHistory.find(t => t.id === id);
              if (!transaction) return;
              
              // Populate modal with transaction details
              document.getElementById('modalTransactionId').textContent = 'TXN-' + transaction.id.toString().padStart(4, '0');
              document.getElementById('modalDateTime').textContent = transaction.time;
              document.getElementById('modalCustomer').textContent = transaction.customer || 'Walk-in Customer';
              document.getElementById('modalPayment').textContent = transaction.payment;
              document.getElementById('modalItems').textContent = transaction.items + ' items';
              document.getElementById('modalTotal').textContent = '$' + transaction.total.toFixed(2);
              
              // Populate products list with detailed information
              const productsList = document.getElementById('modalProductsList');
              productsList.innerHTML = transaction.products.map(product => {
                  const totalPrice = product.price * product.quantity;
                  return '<div class="product-item">' +
                      '<div class="product-info">' +
                          '<img src="' + product.image + '" alt="' + product.name + '" class="modal-product-image">' +
                          '<div class="product-details">' +
                              '<div class="product-name">' + product.name + '</div>' +
                              '<div class="product-quantity">Qty: ' + product.quantity + ' √ó $' + product.price.toFixed(2) + '</div>' +
                          '</div>' +
                      '</div>' +
                      '<div class="product-total">$' + totalPrice.toFixed(2) + '</div>' +
                  '</div>';
              }).join('');
              
              // Show modal
              openModal();
          }

         function editTransaction(id) {
             const transaction = transactionHistory.find(t => t.id === id);
             if (!transaction) return;
             
             alert('Edit functionality would be implemented here for transaction #' + id + '\n\nThis could open a modal or form to edit the transaction details.');
         }

         function deleteTransaction(id) {
             const transaction = transactionHistory.find(t => t.id === id);
             if (!transaction) return;
             
             if (confirm('Are you sure you want to delete this transaction?\n\nTime: ' + transaction.time + '\nTotal: $' + transaction.total.toFixed(2))) {
                 transactionHistory = transactionHistory.filter(t => t.id !== id);
                 updateSalesSummary();
                 updateTransactionsTable();
                 alert('Transaction deleted successfully!');
             }
         }

         // Modal functions
         function openModal() {
             document.getElementById('transactionModal').style.display = 'block';
         }

         function closeModal() {
             document.getElementById('transactionModal').style.display = 'none';
         }

         // Close modal when clicking outside
         window.onclick = function(event) {
             const modal = document.getElementById('transactionModal');
             if (event.target === modal) {
                 closeModal();
             }
         }
    </script>

    <!-- Transaction Details Modal -->
    <div id="transactionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìã Transaction Details</h2>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="transaction-details">
                    <div class="detail-group">
                        <div class="detail-label">Transaction ID</div>
                        <div class="detail-value" id="modalTransactionId">-</div>
                    </div>
                    <div class="detail-group">
                        <div class="detail-label">Date & Time</div>
                        <div class="detail-value" id="modalDateTime">-</div>
                    </div>
                    <div class="detail-group">
                        <div class="detail-label">Customer</div>
                        <div class="detail-value" id="modalCustomer">-</div>
                    </div>
                    <div class="detail-group">
                        <div class="detail-label">Payment Method</div>
                        <div class="detail-value" id="modalPayment">-</div>
                    </div>
                    <div class="detail-group">
                        <div class="detail-label">Total Items</div>
                        <div class="detail-value" id="modalItems">-</div>
                    </div>
                    <div class="detail-group">
                        <div class="detail-label">Total Amount</div>
                        <div class="detail-value" id="modalTotal">-</div>
                    </div>
                </div>
                <div class="products-list">
                    <div class="products-header">üì¶ Products Purchased</div>
                    <div id="modalProductsList"></div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
